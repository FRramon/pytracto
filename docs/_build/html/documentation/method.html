
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Structural Connectivity Matrix Construction &#8212; pytracto 0.1 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=e42486fa" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../_static/documentation_options.js?v=2709fde1"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'documentation/method';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Documentation" href="index.html" />
    <link rel="prev" title="Quickstart" href="../tutorials/index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">pytracto 0.1 documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../install/index.html">
                        Installation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../tutorials/index.html">
                        Quickstart
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="#">
                        Documentation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="index.html">
                        API Reference
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../install/index.html">
                        Installation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../tutorials/index.html">
                        Quickstart
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="#">
                        Documentation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="index.html">
                        API Reference
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"></div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page">Structural...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="structural-connectivity-matrix-construction">
<span id="structural-connectivity"></span><h1>Structural Connectivity Matrix Construction<a class="headerlink" href="#structural-connectivity-matrix-construction" title="Link to this heading">#</a></h1>
<section id="pipeline-adaptation-according-to-mri-data-type">
<h2>1. Pipeline Adaptation According to MRI Data Type<a class="headerlink" href="#pipeline-adaptation-according-to-mri-data-type" title="Link to this heading">#</a></h2>
<p>The initial functions of the pipeline are responsible for verifying the nature of the data. The user only needs to input the dimensions of the structural and diffusion MRI. These verifications include:</p>
<ul class="simple">
<li><p>Checking the number of unique <strong>b-values</strong>: single-shell or multi-shell data.</p></li>
<li><p>Verifying the presence of required files.</p></li>
<li><p>Validating MRI dimensions.</p></li>
</ul>
<p>Several workflows have been developed to accommodate different cases:</p>
<ul class="simple">
<li><p>Multi-shell data &amp; single phase encoding reversal.</p></li>
<li><p>Multi-shell data &amp; multiple phase encoding reversals.</p></li>
<li><p>Multi-shell data with <strong>b = 0</strong> missing phase encoding reversal.</p></li>
<li><p>Single-shell data.</p></li>
<li><p>Single-shell data with <strong>b = 0</strong> missing phase encoding reversal.</p></li>
</ul>
<p>The differences between these workflows are presented in subsequent steps.</p>
</section>
<section id="preprocessing">
<h2>2. Preprocessing<a class="headerlink" href="#preprocessing" title="Link to this heading">#</a></h2>
<p>Diffusion MRI preprocessing consists of four steps:</p>
<ol class="arabic simple">
<li><p><strong>Denoising</strong> using the MP-PCA method, reducing thermal noise.</p></li>
<li><p><strong>Gibbs ringing correction</strong> [7], addressing artifacts appearing during the inverse Fourier transform in <strong>k-space</strong> to image space transition (ref).</p></li>
<li><p><strong>Susceptibility artifact correction</strong> using FSL’s <strong>topup and eddy</strong> algorithms (ref, [8]), applied when reversed-phase <strong>b = 0 s/mm²</strong> images are available. If unavailable (multi-shell synth &amp; single-shell synth workflows), they are synthetically generated using <strong>synb0-Disco</strong> (ref) from the T1w image and <strong>b = 0 s/mm²</strong>.</p></li>
<li><p><strong>B1 field bias correction</strong> is applied.</p></li>
</ol>
<p>Workflow Differences Table:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">+--------------+----------------+------------------+------------+</span>
<span class="o">|</span> <span class="n">Workflow</span>     <span class="o">|</span> <span class="n">Preprocessing</span>  <span class="o">|</span> <span class="n">FOD</span> <span class="n">Estimation</span>   <span class="o">|</span> <span class="n">Tracking</span>   <span class="o">|</span>
<span class="o">+==============+================+==================+============+</span>
<span class="o">|</span> <span class="n">Multi</span> <span class="mi">1</span> <span class="n">AP</span>   <span class="o">|</span> <span class="n">Eddy</span>           <span class="o">|</span> <span class="n">CSD</span> <span class="n">MSMT</span>        <span class="o">|</span> <span class="n">SD_Stream</span>  <span class="o">|</span>
<span class="o">+--------------+----------------+------------------+------------+</span>
<span class="o">|</span> <span class="n">Multi</span> <span class="n">n</span> <span class="n">AP</span>   <span class="o">|</span> <span class="n">Eddy</span>           <span class="o">|</span> <span class="n">CSD</span> <span class="n">MSMT</span>        <span class="o">|</span> <span class="n">SD_Stream</span>  <span class="o">|</span>
<span class="o">+--------------+----------------+------------------+------------+</span>
<span class="o">|</span> <span class="n">Multi</span> <span class="n">Synth</span>  <span class="o">|</span> <span class="n">Synb0</span> <span class="o">+</span> <span class="n">Eddy</span>   <span class="o">|</span> <span class="n">CSD</span> <span class="n">MSMT</span>        <span class="o">|</span> <span class="n">SD_Stream</span>  <span class="o">|</span>
<span class="o">+--------------+----------------+------------------+------------+</span>
<span class="o">|</span> <span class="n">Single</span>       <span class="o">|</span> <span class="n">Eddy</span>           <span class="o">|</span> <span class="n">CSD</span>             <span class="o">|</span> <span class="n">SD_Stream</span>  <span class="o">|</span>
<span class="o">+--------------+----------------+------------------+------------+</span>
<span class="o">|</span> <span class="n">Single</span> <span class="n">Synth</span> <span class="o">|</span> <span class="n">Synb0</span> <span class="o">+</span> <span class="n">Eddy</span>   <span class="o">|</span> <span class="n">CSD</span>             <span class="o">|</span> <span class="n">SD_Stream</span>  <span class="o">|</span>
<span class="o">+--------------+----------------+------------------+------------+</span>
</pre></div>
</div>
</section>
<section id="t1w-image-parcellation-atlas-mapping">
<h2>3. T1w Image Parcellation &amp; Atlas Mapping<a class="headerlink" href="#t1w-image-parcellation-atlas-mapping" title="Link to this heading">#</a></h2>
<p>T1-weighted anatomical images are parcellated using <strong>Freesurfer 7.4.1’s recon-all algorithm</strong> [9]. Cortical reconstruction enables the projection of cortical atlases such as <strong>Schaefer 400</strong> [10], as well as cortical/subcortical atlases like the <strong>Destrieux Atlas</strong> [11].</p>
</section>
<section id="white-matter-tractography">
<h2>4. White Matter Tractography<a class="headerlink" href="#white-matter-tractography" title="Link to this heading">#</a></h2>
<p>White matter fiber reconstruction follows anatomical constraints, using <strong>Constrained Spherical Deconvolution (CSD)</strong> [12] and a <strong>white matter/gray matter interface mask</strong> for streamline initialization. Ten million streamlines are generated using two models:</p>
<ul class="simple">
<li><p><strong>Probabilistic Reconstruction</strong>: iFOD2 [13].</p></li>
<li><p><strong>Deterministic Reconstruction</strong>: SD_Stream.</p></li>
</ul>
<p>A <strong>Spherical-deconvolution Informed Filtering of Tractogram (SIFT)</strong> algorithm [14] refines results by adjusting streamline density to match expected fiber densities.</p>
<p>FOD Estimation and Tracking Table:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">+--------------+----------------------+------------------+----------------+</span>
<span class="o">|</span> <span class="n">Workflow</span>     <span class="o">|</span> <span class="n">Response</span> <span class="n">Estimation</span> <span class="o">|</span> <span class="n">FOD</span> <span class="n">Estimation</span>  <span class="o">|</span> <span class="n">Tracking</span>       <span class="o">|</span>
<span class="o">+==============+======================+==================+================+</span>
<span class="o">|</span> <span class="n">Multi</span><span class="o">-</span><span class="n">Shell</span>  <span class="o">|</span> <span class="n">Dhollander</span>           <span class="o">|</span> <span class="n">CSD</span> <span class="n">MSMT</span>        <span class="o">|</span> <span class="n">SD_Stream</span> <span class="o">&amp;</span> <span class="n">iFOD2</span> <span class="o">|</span>
<span class="o">+--------------+----------------------+------------------+----------------+</span>
<span class="o">|</span> <span class="n">Single</span><span class="o">-</span><span class="n">Shell</span> <span class="o">|</span> <span class="n">Tournier</span>             <span class="o">|</span> <span class="n">CSD</span>             <span class="o">|</span> <span class="n">SD_Stream</span>      <span class="o">|</span>
<span class="o">+--------------+----------------------+------------------+----------------+</span>
</pre></div>
</div>
</section>
<section id="microstructural-maps">
<h2>5. Microstructural Maps<a class="headerlink" href="#microstructural-maps" title="Link to this heading">#</a></h2>
<p>Microstructural maps extract diffusion-related indices:</p>
<ul class="simple">
<li><p><strong>Diffusion Tensor Imaging (DTI)</strong>: axial diffusivity (AD), radial diffusivity (RD), mean diffusivity (MD), fractional anisotropy (FA).</p></li>
<li><p><strong>Multi-compartment models (for multi-shell data, b &gt;= 2500 s/mm²)</strong>: NODDI, SANDI, ActiveAx ([15], ref, ref). The <strong>NODDI model</strong> computes <strong>neurite density index (NDI), free water fraction (FWF), and orientation dispersion index (ODI)</strong> using <strong>AMICO</strong> [16].</p></li>
</ul>
</section>
<section id="connectivity-matrix-construction">
<h2>6. Connectivity Matrix Construction<a class="headerlink" href="#connectivity-matrix-construction" title="Link to this heading">#</a></h2>
<p>Connectivity matrices are generated using the <strong>Destrieux Atlas</strong>, mapped to diffusion space via nearest-neighbor interpolation. Streamlines connecting each pair of gray matter regions are counted, constructing a weighted connectivity matrix. Alternative weightings apply microstructural indices (FA, RD, NDI, etc.) along streamlines to characterize connectivity properties.</p>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../tutorials/index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Quickstart</p>
      </div>
    </a>
    <a class="right-next"
       href="index.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Documentation</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pipeline-adaptation-according-to-mri-data-type">1. Pipeline Adaptation According to MRI Data Type</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preprocessing">2. Preprocessing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#t1w-image-parcellation-atlas-mapping">3. T1w Image Parcellation &amp; Atlas Mapping</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#white-matter-tractography">4. White Matter Tractography</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#microstructural-maps">5. Microstructural Maps</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#connectivity-matrix-construction">6. Connectivity Matrix Construction</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../_sources/documentation/method.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024, Francois Ramon.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.4.7.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.2.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>